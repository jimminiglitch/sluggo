# SlugGo AI Guide
- **Project shape**: Vite-powered vanilla JS/PWA. Entry page [index.html](index.html) mounts the app and loads [src/main.js](src/main.js); styling lives in [src/style.css](src/style.css); PWA assets sit in [public/manifest.json](public/manifest.json) and [public/service-worker.js](public/service-worker.js).
- **Run/Build**: Standard Vite scripts in [package.json](package.json) â€” `npm install`, `npm run dev` for local, `npm run build` for production bundle, `npm run preview` to serve the build.
- **Editor model**: The editor is entirely DOM-driven. `#editor` holds a title page plus one or more `.screenplay-page` elements; screenplay line types map via `ELEMENT_CLASSES` and helpers such as `getCurrentLine()`, `applyElementToCurrentLine()`, and `cycleElementOnCurrentLine()` in [src/main.js](src/main.js). Prefer using/expanding these helpers instead of ad-hoc DOM edits.
- **State & UI flags**: Runtime state is kept in module-scoped variables (`currentElement`, `zoomLevel`, `autocompleteData`, `isDirty`, `fileHandle`, etc.) in [src/main.js](src/main.js). Zoom is applied through CSS var `--zoom`; dark paper toggles `body.dark-paper`.
- **Pagination**: Pages are created via `createNewPage()` and sized to 11in; `checkPageOverflow()` moves overflowing lines to the next page and removes empty trailing pages to keep pagination sane (see [src/main.js](src/main.js)).
- **Input handling**: Global shortcuts and menu buttons route through `menuActions`. Document-level handlers wire Ctrl/Cmd combos (new/open/save/format/zoom/toggle modals), while the editor handler manages Tab element cycling, Enter transitions between element types, and Backspace at page boundaries (see [src/main.js](src/main.js)). Paste is normalized to plain text.
- **Auto-save & local storage**: `markDirty/markSaved` drive UI status. For backward compatibility with existing installs, `saveToStorage()` snapshots `getScriptData()` into `localStorage` key `skryptonite_script` every 30s; tutorial completion is tracked under `skryptonite_tutorial` (see [src/main.js](src/main.js)).
- **File system saves**: `saveScript()` and `openScript()` prefer the File System Access API, storing `.skrypt` (JSON) files; when unavailable, they fall back to download/upload flows. `getScriptData()` serializes metadata inputs and the rendered pages; `loadScriptData()` injects saved HTML back into the editor (see [src/main.js](src/main.js)).
- **Import/Export flows**: `importPlainText()` applies simple Fountain-like heuristics to map text lines into screenplay element classes. `exportFDX()` emits a minimal FDX XML; PDF export uses `window.print()`; `downloadFile()` centralizes blob downloads (see [src/main.js](src/main.js)).
- **UI updates**: `updateUI()` recomputes word/page counts and rebuilds the scene sidebar; `highlightActiveScene()` keeps the sidebar in sync with scroll; clicking a scene item scrolls and moves the cursor to that heading (see [src/main.js](src/main.js)).
- **Autocomplete**: Character and scene-heading suggestions come from `updateAutocompleteData()`; `showAutocomplete()` renders a floating list (max 5) that supports arrow/Enter/Tab selection (see [src/main.js](src/main.js)).
- **Initialization**: `init()` loads any saved draft from localStorage, otherwise seeds a starter page, shows the tutorial once, focuses the editor, and registers the service worker on window load (see [src/main.js](src/main.js)).
- **Styling**: Screenplay layout, margins, fonts, and dark-paper mode are defined in [src/style.css](src/style.css); print styles strip chrome for PDF/print output. Update CSS vars to change theme or page geometry.
- **PWA**: The service worker caches the core asset list declared in [public/service-worker.js](public/service-worker.js); manifest metadata/theme colors live in [public/manifest.json](public/manifest.json). Registration happens in `init()` (see [src/main.js](src/main.js)).
- **Testing**: No automated tests are present; rely on running `npm run dev` and exercising editor interactions manually.
